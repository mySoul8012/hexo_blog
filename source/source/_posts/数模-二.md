title: 数模(二)
author: Ming ming
tags: []
categories:
  - 闲言碎语
  - 数模
date: 2018-09-05 23:36:00
---
数模(二)
# 线性方程组求解
## 定解方程组
$$2x+3y+1z = 4$$
$$4x+2y+3z=17$$
$$7x+1y-1z=1$$
对于上方方程组来说求解过程如下
```
a = [2 3 1; 4 2 3; 7 1 -1];
b = [4 17 1]';
a \ b
```
> ps 注意，需要对b进行转置

通过左除达到求出定解方程组
## 不定方程组
$$4x + 5y + 1z = 3$$
$$1x = 2y + 4z = 15$$
```
a = [4 5 1; 1 2 4];
b = [3 15]';
a\b
```
同样通过左除得出不定方程组的解

## 超定方程组
对于超定方程组来说，其没有解，是根据最小二乘法得出的超定方程组的解
$$4x+5y=3$$
$$1x+1y=12$$
$$3x + 1y = 12$$
```
a = [4 5; 1 2; 3 1]
b = [3 15 12]';
a\b
```
同样通过左除得出超定方程组的解

# pagepank 的 matlab的解法
使用矩阵的形式进行解，求出r的值，根据r的值，进行排序
```
d = 0.85;
n = 6;

c = (1-d)/n*ones(n, 1);

l = [0 1/5 0 0 0 1/5; 0 0 1/3 0 0 1/5;0 1/5 0 0 1/2 1/5; 0 1/5 1/3 0 0 1/5; 0 1/5 0 0 0 1/5; 1 1/5 1/3 1 1/2 0];

i = eye(n); % 单位阵

r = (i-d*l)\c
```

# 线性和非线性拟合
```
x = [1.0, 1.5, 2.0, 2.5, 3.0]';
y = [0.9, 1.7, 2.2, 2.6, 3.0]';
a = polyfit(x, y ,1);
% 下方进行绘图和拟合
xi = 1:0.1:3;
yi = polyval(a, xi);
plot(x, y, 'o', xi, yi);
p = fittype('a*x+b*sin(x)+c');
% 再次进行非线性拟合
f = fit(x, y, p);
% 绘图
plot(f,x,y);
```
一般建议超过3阶的拟合

## 美国人口指数增长模型
指数方程化为线性方程
$$x(t) = x_0e^{rt}$$ 
$$lnx(t) = rt + lnx_0$$
$$y = a_1t+a2$$
代码如下
```
t = 1790:10:1900;
p = [3.9 5.3 7.2 9.6 ... 76.0]
y = log(p);
X = t;
a = polyfit(x, y, 1);
x0 = exp(a(2)); r = a(1);
ti = 1790:1900;
pti = x0*exp(r*ti);
plot(t, p, 'o', ti, pti, 'm');
xlabel('year');
ylabel('population');
```
# 插值和线性回归
插值，一维度插值函数 interp1
> 牙膏模型，此关系为牙膏模型

## 线性回归
$$y = b_0 + b_1x_1 + b_2x_2 + ... + b_kx_k$$

牙膏模型，广告费为x1 为10个数据，接着，x2为另外一个数据，一共10个数据，y为销售量，进行regress得出回归的变量系数，然后置信区间的矩阵为95%。
# 微分方程
疾病传染模型，新闻传播。一个问题为连续问题，连续问题为微分方程和偏微分方程。
## 一阶微分方程
$$y^{'} = cos t$$
```
f = @(t, y) cos(t); % 定义函数的句柄 f(t, y) = cos(t);
tspan = [0, 2*pi];  % 时间范围
y0 = 2； %设定初始值
[t, y] = ode23(f, tspan, y0);   % 使用句柄，将一个函数传入进去
```
## 高阶微分方程
$$y^{'} = -sin y + sin 5t$$
$$y(0) = 1$$
$$y ^ {'}(0) = 0$$
思路，将高阶微分方程转为一阶微分方程
即，y1 = y, y2 = y';
y1' = y2;
y2' = -sin(y1) + sin(5t);
```
f = @(t, y) [y(2); -sin(y(1)) + sin(5*t)];
tspan = [0, 20];
y0 = [1, 0];
[t, y] = ode23(f, tspan, y0);
```
## 传染病模型
传染病模型由三个微分方程构成。
发生流感。
s 易感（所有的人都容易感染） i 感染（已经感染的人） r（康复的人）

单位时间内，易感染的人越来越少，转换的比例βi
$$ds/dt = -βsi$$  

感染人数的变化，易感染的人的人数，减去康复的人数(单位时间)
$$di/dt = βsi - γi$$

康复的人数比例，单位人数
$$dr/dt = γi$$
描述新闻的传播，朋友圈的传播的模型

代码odsir
```
function dy = odesir(t, y ,beta, gamma)
    dy = [-beta*y(1)*y(2); beta*y(1)*y(2) - gamma*y(2); gamma*y(2)];
```

sir
```
n = 100; beta = 0.01; gamma = 0.1;
tspan = [0, 50]; y0 = [99 1 0];
[t y] = ode45(@odesir, tspan, y0, [], beta, gamma);
plot(t, y);
xlabel('time');
ylabel('population');
legend('s', 'i', 'r');
```